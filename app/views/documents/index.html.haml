- set_title t('documents.index_title')

.cover-photo

- if permitted_to? :manage, :documents
  .admin-choices
    %ul
      - if permitted_to? :new, :documents
        %li
          = link_to t("documents.new_document"), new_document_path
      %li
        = link_to t("documents.admin"), admin_documents_path

.menu-button
  = t('layouts.application.menu.menu')

.menu
  .menu-content
    = render_page_content(Page.menu.content, Page.menu.content_type)

.content
  %h1= t('documents.index_title')
  .category-list
    - @categories.each do |category|
      = link_to category.title, anchor: category.title.parameterize

  - @categories.each do |category|
    %h2{ id: category.title.parameterize }= category.title
    
    - if category.documents.empty?
      %p= t('documents.no_documents')
    - else
      - category.documents.group_by{|d| d.publication_date.year }.each do |year, docs|
        %h3= year
        %ul
          - docs.group_by{|o| o.publication_date.month }.each do |month, doc|
            %h4= l(doc.first.publication_date, format: :month)
            - doc.each do |dc|
              %li
                = dc.publication_date
                = link_to dc.title, dc.file.url
