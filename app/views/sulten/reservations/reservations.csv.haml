- require 'csv'

= CSV.generate(headers: true) do |csv|
  - csv << [t("sulten.reservation.name"), t("sulten.reservation.time"), t("sulten.reservation.people"), t("sulten.reservation.reservation_type"), t("sulten.reservation.table"), ]
  
  - @reservations.each do |item|
    csv << item.attributes.values_at(*column names)
    end
  end
end

%table
  %th
    = t("sulten.reservation.table")
  %td
    = @table.number
  %tr
    %th
      = t("sulten.table.capacity")
    %td
      = @table.capacity
  %tr
    %th
      = t("sulten.table.comment")
    %td
      = @table.comment
  %tr
    %th
      = t("sulten.table.available")




- require 'csv'

= CSV.generate(headers: true) do |csv|
  - csv << [t('interviews.applicant_name'),
            t('interviews.applicant_phone_number'),
            t('interviews.applicant_email_address'),
            t('interviews.applicant_campus'),
            t('interviews.job'),
            t('interviews.interview_time'),
            t('interviews.location'),
            t('interviews.interview_status'),
            t('interviews.comment'),
            t('interviews.latest_log_entry')]

  - @job_application_groupings.each do |job_applications|
    - job_applications.each do |job_application|
      - csv_array = [job_application.applicant.full_name,
      job_application.applicant.phone,
      job_application.applicant.email,
      job_application.applicant.campus,
      job_application.title,
      job_application.find_or_create_interview.time,
      job_application.find_or_create_interview.location,
      job_application.find_or_create_interview.acceptance_status]

      - unless job_application.find_or_create_interview.comment.nil?
        - csv_array += [job_application.find_or_create_interview.comment.squish]  # Squish to remove tabs and newlines
      - if job_application.last_log_entry
        - csv_array += [job_application.last_log_entry.log]
      - csv << csv_array


- end.html_safe  # Turn quot into "





%p
  = link_to(T('admissions_admin.export_to_csv'), applications_admissions_admin_admission_group_path(@admission, @group, format: :csv))



Sulten::Table.all
  Sulten::Table Load (0.3ms)  SELECT "sulten_tables".* FROM "sulten_tables" 
 => [#<Sulten::Table id: 5, number: 1, capacity: 8, comment: nil, available: true, created_at: "2017-09-14 17:31:04", updated_at: "2017-09-14 17:31:04">, #<Sulten::Table id: 6, number: 2, capacity: 4, comment: nil, available: true, created_at: "2017-09-14 17:31:04", updated_at: "2017-09-14 17:31:04">] 
